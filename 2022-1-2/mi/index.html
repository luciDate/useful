<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- 禁止手机端缩放小效果 -->
    <meta
      name="viewport"
      content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"
    />
    <title>小米移动商城-yzm</title>
    <link rel="shortcut icon" href="./images/favicon.ico" />
    <link rel="stylesheet" href="./script/mescroll/mescroll.css" />
    <link rel="stylesheet" href="./script/swiper/swiper-3.3.1.min.css" />
    <link rel="stylesheet" href="./css/index.css" />
  </head>
  <body>
    <div class="container">
      <header>
        <!-- 搜索 -->
        <div class="search">
          <div class="logo">
            <img src="./images/logo.png" alt="" />
          </div>
          <div class="search-bar">搜索商品名称</div>
          <div class="search-login">
            <img src="./images/icon-login.png" alt="" />
          </div>
        </div>
        <!-- 菜单 -->
        <div class="scrollx mescroll-touch-x">
          <div id="scrollxContent" class="scrollx-content">
            <ul id="nav" class="nav">
              <li class="active" i="0">推荐</li>
              <li i="1">手机</li>
              <li i="2">智能</li>
              <li i="3">电视</li>
              <li i="4">笔记本</li>
              <li i="5">生活周边</li>
              <li i="6">强烈推荐</li>
              <li i="7">手机周边</li>
              <li i="8">新款游戏本</li>
              <li i="9">雅培</li>
              <li i="10">花王</li>
              <li i="11">韩蜜</li>
            </ul>
          </div>
          <div class="arrow">
            <i></i>
          </div>
        </div>

        <div class="all" style="display: none">
          <div class="title">全部</div>
          <ul>
            <li class="active" i="0"><a>推荐</a></li>
            <li i="1"><a>手机</a></li>
            <li i="2"><a>智能</a></li>
            <li i="3"><a>电视</a></li>
            <li i="4"><a>笔记本</a></li>
            <li i="5"><a>生活周边</a></li>
            <li i="6"><a>强烈推荐</a></li>
            <li i="7"><a>手机周边</a></li>
            <li i="8"><a>新款游戏本</a></li>
            <li i="9"><a>雅培</a></li>
            <li i="10"><a>花王</a></li>
            <li i="11"><a>韩蜜</a></li>
          </ul>
        </div>
        <!-- <ul class="nav">
          <li class="active"><a href="">推荐</a></li>
          <li><a href="">手机</a></li>
          <li><a href="">智能</a></li>
          <li><a href="">电视</a></li>
          <li><a href="">笔记本</a></li>
          <li><a href="">生活周边</a></li>
          <li><a href="">强烈推荐</a></li>
          <li><a href="">手机周边</a></li>
          <li><a href="">新款游戏本</a></li>
        </ul> -->
      </header>

      <div id="swiper" class="swiper-container">
        <div id="swiperWrapper" class="swiper-wrapper">
          <!--首页-->
          <div
            id="mescroll0"
            class="swiper-slide mescroll"
            style="overflow-x: hidden"
          >
            <!-- 轮播图 -->
            <div class="swiper-container1">
              <div class="swiper-wrapper">
                <div class="swiper-slide">
                  <img src="./images/index/slide1!720x360.webp" alt="" />
                </div>
                <div class="swiper-slide">
                  <img src="./images/index/slide2!720x360.webp" alt="" />
                </div>
                <div class="swiper-slide">
                  <img src="./images/index/slide3!720x360.jpg" alt="" />
                </div>
              </div>
              <!-- 如果需要分页器 -->
              <div class="swiper-pagination"></div>
            </div>

            <!-- 图标链接 -->
            <ul class="icon-nav">
              <li>
                <a href="#"
                  ><img src="./images/index/icon-chaozhi!144x152.webp" alt=""
                /></a>
              </li>
              <li>
                <a href="#"
                  ><img src="./images/index/icon-xinpin!144x152.webp" alt=""
                /></a>
              </li>
              <li>
                <a href="#"
                  ><img src="./images/index/icon-yifen!144x152.webp" alt=""
                /></a>
              </li>
              <li>
                <a href="#"
                  ><img
                    src="./images/index/icon-yijiuhuanxin!144x152.webp"
                    alt=""
                /></a>
              </li>
              <li>
                <a href="#"
                  ><img src="./images/index/icon-chaozhi!144x152.webp" alt=""
                /></a>
              </li>
              <li>
                <a href="#"
                  ><img src="./images/index/icon-mifenka!144x152.webp" alt=""
                /></a>
              </li>
              <li>
                <a href="#"
                  ><img src="./images/index/icon-chaozhi!144x152.webp" alt=""
                /></a>
              </li>
              <li>
                <a href="#"
                  ><img src="./images/index/icon-huodong!144x152.webp" alt=""
                /></a>
              </li>
              <li>
                <a href="#"
                  ><img src="./images/index/icon-chaozhi!144x152.webp" alt=""
                /></a>
              </li>
              <li>
                <a href="#"
                  ><img src="./images/index/icon-zhongchou!144x152.webp" alt=""
                /></a>
              </li>
            </ul>

            <!-- 左边一大图，右边两小图 -->
            <div class="threes">
              <div class="threes-left">
                <img src="./images/index/mix3!358x508.webp" alt="" />
              </div>
              <div class="threes-right">
                <div class="threes-right-top">
                  <img
                    src="./images/index/chudianpinleijie!358x252.webp"
                    alt=""
                  />
                </div>
                <div class="threes-right-bottom">
                  <img
                    src="./images/index/xiaomidianshitehui!358x252.webp"
                    alt=""
                  />
                </div>
              </div>
            </div>

            <!-- 一张图布局 -->
            <div class="single">
              <img src="./images/index/hongmi6!720x280.webp" alt="" />
            </div>

            <!-- 产品 -->
            <div class="products">
              <div class="single">
                <img
                  src="./images/lazy.png"
                  data-echo="./images/index/chaozhituijian!720x440.webp"
                  alt=""
                />
              </div>
              <ul>
                <li>
                  <div class="img">
                    <img src="./images/index/mi8qingchun!360x360.webp" alt="" />
                  </div>
                  <a class="intro">
                    <div class="name">小米8 青春版</div>
                    <div class="info">潮流镜面屏，自拍旗舰</div>
                    <div class="price">&yen;1399起</div>
                  </a>
                </li>
                <li>
                  <div class="img">
                    <img src="./images/index/mi8qingchun!360x360.webp" alt="" />
                  </div>
                  <a class="intro">
                    <div class="name">小米8 青春版</div>
                    <div class="info">潮流镜面屏，自拍旗舰</div>
                    <div class="price">&yen;1399起</div>
                  </a>
                </li>
                <li>
                  <div class="img">
                    <img src="./images/index/mi8qingchun!360x360.webp" alt="" />
                  </div>
                  <a class="intro">
                    <div class="name">小米8 青春版</div>
                    <div class="info">潮流镜面屏，自拍旗舰</div>
                    <div class="price">&yen;1399起</div>
                  </a>
                </li>
                <li>
                  <div class="img">
                    <img src="./images/index/mi8qingchun!360x360.webp" alt="" />
                  </div>
                  <a class="intro">
                    <div class="name">小米8 青春版</div>
                    <div class="info">潮流镜面屏，自拍旗舰</div>
                    <div class="price">&yen;1399起</div>
                  </a>
                </li>
              </ul>

              <a class="more" href="#">更多 ></a>
            </div>
          </div>

          <!--奶粉-->
          <div id="mescroll1" class="swiper-slide mescroll">
            <div>
              <img src="./images/index/phone/mi8.webp" alt="" />
            </div>
          </div>

          <!--面膜-->
          <div id="mescroll2" class="swiper-slide mescroll">
            <div>
              <img src="./images/index/zhineng/mijiatouyingyi.webp" alt="" />
            </div>
          </div>

          <!--图书-->
          <div id="mescroll3" class="swiper-slide mescroll">电视</div>

          <!--果汁-->
          <div id="mescroll4" class="swiper-slide mescroll">笔记本</div>

          <!--奶瓶-->
          <div id="mescroll5" class="swiper-slide mescroll">生活周边</div>

          <!--美素-->
          <div id="mescroll6" class="swiper-slide mescroll">强烈推荐</div>

          <!--璐拉-->
          <div id="mescroll7" class="swiper-slide mescroll">手机周边</div>

          <!--启赋-->
          <div id="mescroll8" class="swiper-slide mescroll">新款游戏本</div>

          <!--雅培-->
          <div id="mescroll9" class="swiper-slide mescroll">雅培</div>

          <!--花王-->
          <div id="mescroll10" class="swiper-slide mescroll">花王</div>

          <!--韩蜜-->
          <div id="mescroll11" class="swiper-slide mescroll">韩蜜</div>
        </div>
      </div>
    </div>

    <!-- 底部 -->
    <div class="footer">
      <a href="./index.html">
        <img src="./images/icon-home-active.png" alt="" />
        <span>首页</span>
      </a>
      <a href="./category.html">
        <img src="./images/icon-category.png" alt="" />
        <span>分类</span>
      </a>
      <a href="./cart.html">
        <img src="./images/icon-cart.png" alt="" />
        <span>购物车</span>
      </a>
      <a href="./my.html">
        <img src="./images/icon-login.png" alt="" />
        <span>我的</span>
      </a>
    </div>
    <script src="./script/zepto/zepto.js"></script>
    <script src="./script/mescroll/mescroll.js"></script>
    <script src="./script/swiper/swiper-3.3.1.min.js"></script>
    <script src="./script/echo/echo.js"></script>
    <script>
      $(function () {
        document.querySelector("html").style.fontSize =
          (window.screen.width / 640) * 100 + "px";

        // 存mescroll的数组对象
        var mescrollArr = [];
        // 当前菜单的下标
        var curNavIndex = 0;
        // 初始化第一个菜单，也就是第一个mescroll
        mescrollArr[curNavIndex] = initMescroll(curNavIndex);

        function initMescroll(index) {
          var mescroll = new MeScroll("mescroll" + index, {});
          return mescroll;
        }

        var swiper = new Swiper("#swiper", {
          onTransitionEnd: function (swiper) {
            var i = swiper.activeIndex;
            changePage(i);
          },
        });

        $("#nav li").on("click", function () {
          var i = Number($(this).attr("i"));
          console.log(i);
          swiper.slideTo(i);
        });

        function changePage(i) {
          if (curNavIndex != i) {
            // 改变菜单状态
            var curNavDom;
            $("#nav li").each(function (n, dom) {
              if (dom.getAttribute("i") == i) {
                dom.classList.add("active");
                curNavDom = dom;
              } else {
                dom.classList.remove("active");
              }
            });
            $(".all ul li").each(function (n, dom) {
              if (dom.getAttribute("i") == i) {
                dom.classList.add("active");
              } else {
                dom.classList.remove("active");
              }
            });
            // 居中动画效果
            var scrollxContent = document.getElementById("scrollxContent");
            var star = scrollxContent.scrollLeft; //当前位置
            var end =
              curNavDom.offsetLeft +
              curNavDom.clientWidth / 2 -
              document.body.clientWidth / 2; //居中
            mescrollArr[curNavIndex].getStep(star, end, function (step, timer) {
              scrollxContent.scrollLeft = step; //从当前位置逐渐移动到中间位置,默认时长300ms
            });
            //隐藏当前回到顶部按钮
            mescrollArr[curNavIndex].hideTopBtn();

            // 初始化新的mescroll，如果已经初始化过，那就不用初始化了，直接显示
            if (mescrollArr[i] == null) {
              mescrollArr[i] = initMescroll(i);
            } else {
              //检查是否需要显示回到到顶按钮
              var curMescroll = mescrollArr[i];
              var curScrollTop = curMescroll.getScrollTop();
              if (curScrollTop >= curMescroll.optUp.toTop.offset) {
                curMescroll.showTopBtn();
              } else {
                curMescroll.hideTopBtn();
              }
            }
            // 更新当前mescroll的索引
            curNavIndex = i;
          }
        }

        $(".arrow").click(function () {
          $(".arrow i").toggleClass("up");
          $(".all").toggle();
        });

        $(".all ul li").click(function () {
          var i = Number($(this).attr("i"));
          console.log(i);
          swiper.slideTo(i);
          $(".arrow i").toggleClass("up");
          $(".all").toggle();
        });

        var swiperSlides = new Swiper(".swiper-container1", {
          loop: true,
          //autoplay:1500,
          width: window.innerWidth,
          // 如果需要分页器
          pagination: ".swiper-pagination",
        });

        Echo.init({
          // 离可视区域多少像素的图片可以被加载
          offset: 800,
          throttle: 0,
        });
      });
    </script>
  </body>
</html>
